\chapter{METODOLOGIA \label{metodologia}}

\hspace*{1.25cm}Neste Capítulo, serão definidas as metodologias a serem utilizada
para a realização da detecção de transições.

\begin{figure}[h|top]
 \centering
 \includegraphics[width=1.0\linewidth]{imagens/metodologia.png}
 \caption{Diagrama esquemático da metodologia proposta.}
 \label{img_metodologia}
\end{figure}

\hspace*{0.65cm}A Figura \ref{img_metodologia} mostra um esquema geral da
metodologia proposta neste trabalho, que consistem em : à partir de um dado vídeo de entrada
o sistema realizará a detecção de suas transições (corte/fade/dissolve). Após este processo
o vídeo poderá ser editado, com aplicações de efeitos visuais.

\begin{numerate}

\item{

\end{numerate}

\section{Cortes \label{met_cortes}}

\begin{figure}[h|top]
 \centering
 \includegraphics[width=0.9\linewidth]{imagens/metodologia_cortes.png}
 \caption{Metodologia utilizada para a detecção de Cortes.}
 \label{img_metcortes}
\end{figure}

\hspace*{1.25cm}A Figura \ref{img_metcortes} representa a metodologia utilizada para
a detecção de transições do tipo Corte:

\subsection{Montagem do Ritmo Visual por sub-amostragem\label{met_cortes_RV}}

Para realizar a detecção das transições, o sistema irá gerar uma
imagem 2D, representando o Ritmo Visual do vídeo.

Este processo se dá a partir dos seguintes passos:

\begin{itemize}
\item{Obtenção do Frame}
\item{Cálculo da Diagonal Principal do Frame}
\end{itemize}

Tais passos se repetem do primeiro, até o último frame do vídeo, de
forma seqüencial.

\subsection{Suavização da imagem \label{met_cortes_suavizacao}}

Homogeneização da imagem  através da aplicação de um filtro espacial
do tipo passa-baixas, o qual utiliza o processo de convolução (Seção
\ref{filtragem_espacial}), permitindo que a imagem torne-se mais
suave e com menos ruídos.

\subsection{Operador Sobel \label{met_cortes_sobel}}

Uma vez suavizada a imagem, será aplicado o operador Sobel, para
realizar a detecção das bordas. Como visto na seção
\ref{deteccao_de_bordas}, com a aplicação deste operador é possível
obter o mapa de bordas do Ritmo Visual, o qual irá mostrar a
localização de possíveis transições de cortes no vídeo.

\subsection{Limiar de corte e contagem de pontos \label{met_cortes_limiar}}

Gerado o mapa de bordas, será necessário determinar quais bordas
serão consideradas transições de cortes e quais serão ignoradas pelo
fato de pertencerem a objetos da imagem. Tal processo será realizado
através da contagem de pontos pertencentes às retas verticais
detectadas. Quanto maior for este número, maior a possibilidade da
borda estar representando um corte. Com isso, gera-se uma limiar, o
que possibilita realizar a classificação entre aquilo que representa
a borda de um objeto, e daquilo que representa uma transição de
corte.

\subsection{Cortes detectados \label{met_cortes_detectados}}

No final deste processo, estarão identificadas as transições de
corte do vídeo.

\section{Fade-In \label{met_fadein}}

\begin{figure}[h|top]
 \centering
 \includegraphics[width=1.0\linewidth]{imagens/metodologia_fades.png}
 \caption{Metodologia utilizada para a detecção de Fade.}
 \label{img_metfades}
\end{figure}

Como visto na Seção \ref{ed_fadein}, o fade-in é uma transição de
tomadas mais escuras para tomadas mais claras.

\subsection{Ritmo Visual por Histograma ($RVH$)\label{met_fadein_rvh}}

O primeiro passo para a detectar um fade-in é a partir de um video de entrada,
deve-se analisar cada frame, obter deles seu histograma e obter os Pontos Máximos deste histograma,
montando assim um Ritmo Visual por Histograma.

O RVH de uma sequência que contém um fade-in ficará como a Figura \ref{img_met_fadein_rvh}.
Onde o eixo $x$ representa a média da luminância do frame, e o eixo $y$ representa cada
frame do vídeo.

\begin{figure}[h|top]
 \centering
 \includegraphics[width=1.0\linewidth]{imagens/metodologia_fadein_rvh.png}
 \caption{RVH de uma sequência que contém uma transição do tipo fade-in.}
 \label{img_met_fadein_rvh}
\end{figure}

\subsection{Diagonal do Frame \label{mt_fadein_rvdiagonal}}

A partir de cada frame extraido do vídeo, a regiao de interesse no frame eh sua diagonal, entao uma nova imagem
eh criada a partir dela.

\subsection{Histograma da Diagonal \label{met_fadein_histograma_diagonal}}

Com esta imagem contendo somente a diagonal da imagem inicial, criamos um histograma.

\subsection{Ponto Máximo do Histograma \label{met_fadein_rvmax}}

Com base neste Histograma, são obtidos os pontos de Maxima, que consiste
no ponto (escala de cinza) que tem maior incidência na imagem. Estes pontos
são obtidos de cada histograma, os quais irão compor a curva do gráfico.

\subsection{Cálculo de Derivadas do $RVH$\label{met_fadein_derivadas}}

A derivada é aplicada na curva do gráfico afim de encontrar variações nos
padrõs dos histogramas previamente coletados. Ela evidenciará
quando em uma sequência de frames houver uma modificação no padrão
dos frames, que é representada, neste caso, por uma derivada com
valor maior que $0$.

Quando a sequência de frames mantém-se normalizada, as derivadas dos pontos
serão $0$, quando fade-in se inicia, a curva do gráfico começa a avançar com sentido contrário
ao vértice, tendo derivada positiva. Chega um instante em que a curva do gráfico atinge
um pico máximo, onde este é o ponto exato do fim do fade-in. Após isto a curva do gráfico
tende a se normalizar novamente, pois neste momento a nova tomada já está
totalmente em cena.

Para o fade-in, as derivadas são positivas quando o efeito começa.

%O gráfico da derivada do RVH de uma sequência com transição do tipo fade-in, ficará como
%a Figura \ref{img_met_fadein_derivada_rvh}.

%\begin{figure}[h|top]
% \centering
% \includegraphics[width=1.0\linewidth]{imagens/metodologia_fadein_derivada_rvh.png}
% \caption{Derivada do RVH de uma sequência que contém uma transição do tipo fade-in.}
% \label{img_met_fadein_derivada_rvh}
%\end{figure}

\subsection{Obtenção do Ponto de Derivada Máxima \label{met_fadein_derivada_maxima}}

Após calcular a derivada dos pontos da curva do gráfico, é necessário
detectar o ponto máximo(pico) da derivada, este evidencia o ponto exato
onde houve o pico de variação de padrões na tomada, o que caracteriza o
ponto onde a transição de fade teve seu ápice. É neste ponto onde será
delimitada a transição.

\subsection{Fade-In Detectado \label{met_fadein_detectado}}

No final deste processo, tem-se o ponto para demarcação de onde a
transição de fade ocorreu. Basta então demarcar no video este efeito.

\section{Fade-Out \label{met_fadeout}}

Como será visto na Seção \ref{ed_fadeout}, o fade-out é uma transição de
tomadas mais claras para mais escuras.

\subsection{Ritmo Visual Por Histograma ($RVH$) \label{met_fadeout_rvh}}

O Ritmo Visaul do fade-out é calculado como visto na Seção \ref{met_fadein_rvh}.
Apesar de ser o mesmo processo que o fade-in, a representação de um fade-out
tem uma curva no gráfico inversa%, como a da Figura \ref{img_met_fadeout_rvh}

%\begin{figure}[h|top]
% \centering
% \includegraphics[width=1.0\linewidth]{imagens/metodologia_fadeout_rvh.png}
% \caption{Representação do RVH de uma sequência que contém uma transição do tipo fade-out.}
% \label{img_met_fadeout_rvh}
%\end{figure}

\subsection{Detectando o fade-out \label{met_fadeout_detectando}}

A técnica utilizada para detectar um fade-out é a mesma utilizada no
fade-in (Seção \ref{met_fadein}), porém a interpretação das derivadas da
curva do gráfico deve ser feita de um modo diferente. Ao invés de obter o
ponto de derivada máxima, como no fade-in, o fade-out obtém o ponto de
derivada mínima, como visto a seguir.

\subsection{Obtenção do Ponto de Derivada Mínima \label{met_fadein_derivada_maxima}}

No momento que o fade-out começa, as derivadas da curva do gráfico começam a ter valores negativos,
pois a curva do gráfico caminha em direção ao vértice. Nos outros passos, a metodologia é igual ao do fade-in.

%Um exemplo de representação desta derivada é encontrado na Figura \ref{img_met_fadeout_derivada_rvh}.

%\begin{figure}[h|top]
% \centering
% \includegraphics[width=1.0\linewidth]{imagens/metodologia_fadeout_derivada_rvh.png}
% \caption{Representação do RVH de uma sequência que contém uma transição do tipo fade-out.}
% \label{img_met_fadeout_derivada_rvh}
%\end{figure}

\subsection{Fade-Out Detectado \label{met_fadein_detectado}}

No final deste processo, tem-se o ponto para demarcação de onde a
transição de fade ocorreu. Basta então demarcar no video este efeito.

\section{Dissolve \label{met_dissolve}}

\begin{figure}[h|top]
 \centering
 \includegraphics[width=1.0\linewidth]{imagens/metodologia_dissolve.png}
 \caption{Metodologia utilizada para a detecção de dissolve.}
 \label{img_metdissolve}
\end{figure}

Como visto na Seção \ref{ed_Dissolve}, o dissolve é uma transição
baseado na sobreposições de imagens.

\subsection{Ritmo Visual por Histograma\label{met_dissolve_rv}}

O primeiro passo para a detectar um dissolve é a partir de um video
de entrada, deve-se analisar cada frame, e obter deles seu
histograma, montando assim um Ritmo Visual por Histograma.

%O RVH de uma sequência de dissolve tem uma curva parecida com
%a da Figura \ref{img_met_dissolve_rvh}.

%\begin{figure}[h|top]
% \centering
% \includegraphics[width=1.0\linewidth]{imagens/metodologia_dissolve_rvh.png}
% \caption{Representação do RVH de uma sequência que contém uma transição do tipo dissolve.}
% \label{img_met_dissolve_rvh}
%\end{figure}

\subsection{Variância dos frames do Vídeo\label{met_dissolve_variancia}}

A partir de cada diagonal do frame do vídeo $V$, é calculado um desvio padrão $DP_V$.
A variância $VAR(V)$ é igual ao $ VAR(V) = DP_V^2 $.

\subsection{Derivada Segunda da curva de Variância \label{met_dissolve_2derivada_variancia}}

A pártir da curva do gráfico da variância, é cálculado a sua derivada segunda, com o
objetivo de limitar cada vez as mais os pontos de variação da curva.

\subsection{Derivada do RVH \label{met_dissolve_derivada_rvh}}

A partir do RVH, é calculado a derivada, com o objetivo
de limitar os pontos de variação da curva, que são os pontos representativos
do dissolve.

\subsection{Razão entre Derivada Segunda da curva de Variância e Derivada do RVH\label{met_dissolve_razao_rvh}}

Com esta razão as transições de tipo dissolve ficaram expostas na curva do gráfico
como regiões onde o pico é muito baixo.

\subsection{Dissolve detectado \label{met_dissolve_detectado}}

No final deste processo, tem-se o ponto para demarcação de onde a
transição de dissolve ocorreu. Basta então demarcar no video este
efeito.
