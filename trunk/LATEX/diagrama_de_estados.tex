\section{Diagrama de Estados \label{state_diagram}}

\begin{figure}[h|top]
 \centering
 \includegraphics[width=1.0\linewidth]{imagens/state_diagram.png}
 \caption{Diagrama de estados do sistema.}
 \label{img_state_diagram}
\end{figure}

\subsection{Estado: Busca Vídeo \label{st_video_search}}

Sistema entra no estado de busca do vídeo informado pelo usuário.

\subsection{Estado: Carrega Vídeo \label{st_load_video}}

Sistema passa para o estado de carregamento do vídeo, caso o caminho
e arquivo informado pelo usuário estejam corretos, senão volta para
o estado de busca do vídeo.

\subsection{Estado: Detecção de Transições \label{st_detect_transitions}}

Caso o usuário opte por realizar a detecção de transições logo após
o carregamento do vídeo, o sistema entra no estado de detecção de
transições e segue para diversos outros estados internos dependendo
da escolha do tipo de detecção a ser feita pelo usuário.

O sistema entra neste estado sempre que o usuário solicitar a
detecção de transições.

\subsubsection{Estado: Detecção de Cortes \label{st_cut_detection}}

Estado interno do estado Detecção de Transições.

Sistema entra em estado de detecção de cortes. Neste estado são
detectados todos os cortes do vídeo.

Este estado possui os seguintes estados internos:

\begin{enumerate}

\item{\textbf{Obtendo RV por amostragem}

Sistema entra neste estado para a geração do Ritmo Visual por
amostragem (extração de diagonais dos frames) do vídeo.
}

\item{\textbf{Suavizando imagem}]

Sistema entra no estado em que é feita a suavização da imagem
através de filtros espaciais, no caso, o filtro passa-baixa.
}

\item{\textbf{Montando Mapa de Bordas}

Sistema entra no estado de montagem do mapa de bordas. Neste estado
é aplicado o operador Sobel no Ritmo Visual, gerando o mapa de
bordas.
}

\item{\textbf{Definição de limiar}

Sistema entra no estado onde é definido o limiar de corte para a
contagem de pontos das verticais existentes na imagem.
}

\item{\textbf{Definição manual}

Caso o limiar definido pelo sistema não seja aceito pelo usuário, o
sistema entra em estado de definição manual do limiar de corte.
}

\item{\textbf{Contando pontos de linhas}

Sistema entra no estado de contagem de pontos de linhas, onde é
feita a contagem e seleção das retas que representam um corte no
vídeo.
}

\end{enumerate}

\subsubsection{Estado: Detecção de Fades \label{st_fade_detection}}

Estado interno do estado Detecção de Transições.

Sistema entra em estado de detecção de fades. Neste estado são
detectados os fade-in, fade-out ou ambos.

Este estado possui os seguintes estados internos:

\begin{enumerate}

\item{\textbf{Obtendo RV por Histograma}

Sistema entra neste estado para a geração do Ritmo Visual por
Histograma (extração de diagonais dos frames e caluclo dos histogramas) do vídeo.
}

\item{\textbf{Calculando Derivadas}

Sistema entra no estado em que é feito o cálculo das derivadas
do RVH
}

\item{\textbf{Obtendo Derivada Máxima}

Caso o intuito seja detectar fade-in (ou ambos), entra-se no estado de obtenção da derivada máxima.
Este estado é necessário para definir os pontos onde ocorreram os fade-in.
}

\item{\textbf{Obtendo Derivada Mínima}

Caso o intuito seja detectar fade-out (ou ambos), entra-se no estado de obtenção da derivada mínima.
Este estado é necessário para definir os pontos onde ocorreram os fade-out.
}

\end{enumerate}

\subsubsection{Estado: Detecção de Dissolve \label{st_dissolve_detection}}

Estado interno do estado Detecção de Transições.

Sistema entra em estado de detecção de dissolve. Neste estado são
detectadas transições do tipo dissolve.

Este estado possui os seguintes estados internos:

\begin{enumerate}

\item{\textbf{Obtendo RV por Histograma}

Sistema entra neste estado para a geração do Ritmo Visual por
Histograma. }

\item{\textbf{Calculando Variância}

Sistema entra no estado em que a partir da diagonal do frame
calcula-se o seu desvio padrão, para se obter a sua variância. }

\item{\textbf{Calculando Derivada do RV}

Sistema entra no estado em que a partir do RVH gerado, calcula-se a
primeira derivada, para acentuação dos pontos de transições }

\item{\textbf{Calculando Derivadas da Variância}

A partir da variância, calcula-se a sua segunda derivada para
indicar os pontos de transição. }

\item{\textbf{Calculando razão entre DRV / D2V}

Sistema entra no estado  para calcular a razão entre a 1. derivada
do RVH e a 2. derivada da variância, retornando o trecho exato onde
ocorre o dissolve. }

\end{enumerate}

\subsection{Estado: Atualizando Timeline \label{st_timeline_update}}

Realizadas as detecções de transições, independente do tipo de
detecção, o sistema entra em estado de atualização da timeline do
vídeo.

\subsection{Estado: Ajuste manual \label{st_manual_adjust}}

Caso os pontos de transição definidos pelo sistema não sejam aceitos
pelo usuário, este poderá ajustá-los manualmente, fazendo com que o
sistema entre no estado de ajuste manual das transições.

\subsection{Estado: Repouso \label{st_rest}}

Após o carregamento do vídeo o usuário tem a opção de realizar a
detecção de todas as transições do vídeo. Caso opte por não realizar
a detecção de transições o sistema entra em estado de repouso,
aguardando alguma ação do usuário.

\subsection{Estado: Em edição \label{st_edition}}

Sistema entra no estado de edição do vídeo, sempre que o usuário for
realizar qualquer tipo de edição no vídeo (aplicação de efeitos,
alteração de luminosidade, dentre outros).
