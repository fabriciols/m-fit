\chapter{METODOLOGIA \label{metodologia}}

\hspace*{1.25cm}Neste Capítulo, serão definidas as metodologias a serem utilizada
para a realização da detecção de transições.

\begin{figure}[h|top]
    \centering
    \includegraphics[width=1.0\linewidth]{imagens/metodologia.png}
    \caption{Diagrama esquemático da metodologia proposta.}
    \label{img_metodologia} Fonte: Autor.
\end{figure}

\hspace*{0.65cm}A Figura \ref{img_metodologia} mostra um esquema
geral da metodologia proposta neste trabalho, que consiste em: a
partir de um dado vídeo de entrada o sistema realizará a detecção de
suas transições (corte/fade/dissolve), sendo que para cada tipo de
transição, será aplicada uma metodologia diferente, as quais serão
detalhadas posteriormente. Após estes processos o vídeo poderá ser
editado, com aplicação de efeitos visuais.

\section{Cortes \label{met_cortes}}

\begin{figure}[h|top]
    \centering
    \includegraphics[width=1.0\linewidth]{imagens/metodologia_cortes.png}
    \caption{Metodologia utilizada para a detecção de Cortes.}
         \label{img_metcortes} Fonte: Autor.
\end{figure}

\hspace*{1.25cm}A Figura \ref{img_metcortes} representa a metodologia utilizada para
a detecção de transições do tipo Corte:

\begin{enumerate}

    \item{\textbf{Vídeo:} É feita a entrada do vídeo no qual será feita a detecção dos cortes.}

    \item{\textbf{Montagem do Ritmo Visual por sub-amostragem:} Para realizar a detecção das transições,
    o sistema irá gerar uma imagem 2D que representa o Ritmo Visual do
    vídeo, como definido na Seção \ref{ritmo_visual}.

    \hspace*{0.65cm}Este processo se dá de acordo com os seguintes passos:

    \begin{enumerate}
        \item{Obtenção do Frame;}
        \item{Conversão do Frame para tons de cinza;}
        \item{Cálculo da Diagonal Principal deste Frame.}
    \end{enumerate}

    \hspace*{0.65cm}Tais passos se repetem do primeiro, até o último frame do vídeo.}

    \item{\textbf{Segmentação de Imagem - Extração da área de interesse:} Para vídeos que estejam no
    formato \textit(widescreen), será realizada a extração da área de interesse (área do vídeo), para
    que não haja interferência nos resultados por parte das bordas pertencentes ao \textit(widescreen). }

    \item{\textbf{Detecção de Bordas - Operador Canny:} Será aplicado o operador Canny para
    realizar a detecção das bordas. Como visto na Seção
    \ref{deteccao_de_bordas}, com a aplicação deste operador, é possível
    obter o mapa de bordas do Ritmo Visual, o qual irá mostrar a
    localização de possíveis transições de cortes no vídeo.}

    \item{\textbf{Mapa de Bordas:} Gerado com a aplicação do Operador Canny no RV, o mapa de bordas possibilitará a definição dos pontos
    onde há a ocorrência dos cortes.}

    \item{\textbf{Limiar de corte e contagem de pontos:} Gerado o mapa de bordas, será necessário determinar quais bordas
    serão consideradas transições de cortes e quais serão ignoradas pelo
    fato de pertencerem a objetos da imagem. Tal processo será realizado
    através da contagem de pontos pertencentes às retas verticais
    detectadas. Quanto maior for este número, maior a possibilidade da
    borda estar representando um corte. Para isso, define-se um limiar, o
    que possibilita realizar a classificação entre aquilo que representa
    uma borda gerada por um objeto, e daquilo que representa uma transição de
    corte.}

    \item{\textbf{Transições:}
    No final deste processo, estarão identificadas as transições do vídeo
    do tipo corte.}
\end{enumerate}


\section{Fade \label{met_fade}}

\begin{figure}[h|top]
    \centering
    \includegraphics[width=1.0\linewidth]{imagens/metodologia_fades.png}
    \caption{Metodologia utilizada para a detecção de Fade.}
    \label{img_metfades} Fonte: Autor.
\end{figure}

Como visto na Seção \ref{ed_fadein}, o fade-in é uma transição de
tomadas mais escuras para tomadas mais claras, enquanto o fade-out,
visto na Seção \ref{ed_fadeout}, possui um efeito inverso, ou seja,
de tomadas mais claras para tomadas mais escuras.

Devido à similaridade entre estas duas transições, a metodologia
utilizada para a detecção de ambas será semelhante, como pode ser
visto na Figura \ref{img_metfades}. Primeiramente será mostrada a
metodologia do fade-in e posteriormente serão comentadas as
diferenças da mesma em relação ao fade-out.

\subsection{Fade-in \label{met_fadein}}

O processo para detecção de transições do tipo fade-in será:

\begin{enumerate}
    \item{\textbf{Vídeo:} É feita a entrada do vídeo no qual será feita a detecção dos fade-in.}

    \item{\textbf{Ritmo Visual por Histograma (RVH):} A partir do vídeo de entrada, cria-se uma simplificação
    do mesmo chamada Ritmo Visual por Histograma (Seção
    \ref{ritmo_visual_histograma}).

    O processo para criar um RVH possui os seguintes passos:
    \begin{enumerate}
    \item{Obtenção do Frame;}
    \item{Converte Frame para tons de cinza;}
    \item{Cálculo da Diagonal Principal deste Frame;}
    \item{Obtenção do Histograma desta diagonal.}
    \end{enumerate}
    \hspace*{0.65cm}Tais passos se repetem seqüencialmente do primeiro,
    até o último frame do vídeo.

    \hspace*{0.65cm}Um exemplo de um RVH de uma sequência de vídeo onde
    ocorre um fade-in pode ser visto na Figura \ref{img_met_fadein_rvh}.
    Onde o eixo $x$ representa os valores de luminância extraídos de
    cada diagonal do frame, e o eixo $y$ representa cada frame do vídeo.

    }

    \begin{figure}[h|top]
        \centering
        \includegraphics[width=1.0\linewidth]{imagens/metodologia_fadein_rvh.png}
        \caption{RVH de uma sequência que contém uma transição do tipo
        fade-in.} \label{img_met_fadein_rvh} Fonte: Adaptado de \cite{FERNANDO_1999}.
    \end{figure}

    \item{\textbf{Cálculo das Derivadas do RVH:} Obtido o RVH,
    calcula-se a sua derivada primeira. A partir da função derivada, é
    possível visualizar o comportamento de um fade-in. No momento em que
    a sequência estiver com seus frames mais escuros, a curva se manterá
    mais constante, ao iniciar o processo da transição (clareamento da
    tomada), ocorrerá uma forte variação na curva, a qual se manterá até
    o momento em que a luminosidade dos frames deixe de variar, fazendo
    também com que o comportamento da curva torne-se estável novamente.}

    \item{\textbf{Obtenção do Ponto de Derivada Máxima:} Como visto no
    passo anterior, conforme a tomada torna-se mais clara, a curva da
    derivada passa a sofrer uma determinada variação. No momento em que
    não houver mais variação na luminosidade dos frames, a curva irá
    manter-se aproximadamente constante, e é neste momento em que a derivada atingirá o
    seu valor máximo, o qual caracteriza a ocorrência do fade-in.}

    \item{\textbf{Transições Fade-in:} No final deste processo, as transições do tipo fade-in estarão detectadas.}
\end{enumerate}

\subsection{Fade-Out \label{met_fadeout}}

A diferença na abordagem do fade-out sobre o fade-in é que: o para o fade-out é necessário
a captura do ponto de derivada mínima, enquanto no fade-in era o ponto de derivada máxima.

\begin{enumerate}
    \item{\textbf{Obtenção do Ponto de Derivada Mínima:} Para obtermos a definição exata do
    ponto de ocorrência do fade-out é necessário definir o momento
    (frame) em que a derivada atinge o seu valor mínimo, o qual
    representa o ponto onde a tomada torna-se completamente escura.}

    \item{\textbf{Transições Fade-out:} No final deste processo, as transições do tipo fade-out estarão detectadas.}
\end{enumerate}

\section{Dissolve \label{met_dissolve}}

\begin{figure}[h|top]
    \centering
    \includegraphics[width=1.0\linewidth]{imagens/metodologia_dissolve.png}
    \caption{Metodologia utilizada para a detecção de dissolve.}
    \label{img_metdissolve} Fonte: Adaptado de \cite{FERNANDO_1999}.
\end{figure}

\hspace*{1.25cm}A Figura \ref{img_metcortes} representa a metodologia utilizada para
a detecção de transições do tipo Dissolve:

\begin{enumerate}
    \item{\textbf{Vídeo:} É feita a entrada do vídeo no qual será feita a detecção das transições do tipo Dissolve.}

    \item{\textbf{Cálculo do RV por Histograma:} Para a realização da detecção de transições do tipo
    dissolve, o sistema irá primeiramente gerar o RVH do vídeo.}

    \hspace*{0.65cm}Este processo se dá através dos seguintes passos:

    \begin{enumerate}
        \item{Obtenção do Frame;}
        \item{Converte Frame para tons de cinza;}
        \item{Cálculo da Diagonal Principal deste Frame;}
        \item{Obtenção do Histograma desta diagonal.}
        \item{Cálculo da Variância do Histograma.}
    \end{enumerate}

    \hspace*{0.65cm}Tais passos se repetem seqüencialmente do primeiro,
    até o último frame do vídeo.

    \item{\textbf{Verifica pontos de dissolve com 7 pontos seguintes:} A partir dos pontos do Ritmo visual por historgrama, é verificado
    os próximos 7 pontos. Caso estes pontos estejam em ordem crescente, este ponto é um possível ponto de dissolve.}

    \item{\textbf{Derivada dos possíveis pontos de Dissolve:} Para os possíveis pontos de Dissolve, a derivada destes pontos é calculada,
     comparando os resultados obtidos a um threshold definido.}

    \item{\textbf{Detecção do Dissolve:} Caso os pontos em questão forem todos menores que o threshold,
    o primeiro ponto é o início do Dissolve.}

    \item{\textbf{Dissolve detectado:} No final deste processo,
    estarão identificados os pontos de ocorrência de transições do tipo Dissolve.}
    \end{enumerate}
